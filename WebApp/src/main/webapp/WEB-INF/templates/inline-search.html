<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns="http://www.w3.org/1999/xhtml"
      lang="en">
<head>
    <base href="../../" th:remove="all"/>
    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title th:text="#{registration.title}">Regtst</title>

    <!-- Bootstrap CSS -->
    <link th:href="@{/css/bootstrap.min.css}" href="css/bootstrap.min.css" rel="stylesheet"/>

    <!-- Material design CSS -->
    <link th:href="@{/css/ripples.min.css}" href="css/ripples.min.css" rel="stylesheet"/>
    <link th:href="@{/css/material-wfont.min.css}" href="css/material-wfont.min.css"
          rel="stylesheet"/>

    <!-- Kupra CSS -->
    <link th:href="@{/css/kupra.css}" href="css/kupra.css" rel="stylesheet"/>

    <!-- jQuery -->
    <script th:src="@{jquery-1.11.1.min.js}" src="js/jquery-1.11.1.min.js"
            type="application/javascript"></script>

    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
<div th:fragment="head">
    <!-- Kupra CSS -->
    <link th:href="@{/css/search.css}" href="css/search.css" rel="stylesheet"/>
    <!-- Typeahead -->
    <script th:src="@{typeahead.bundle.js}" src="js/typeahead.bundle.js"
            type="application/javascript"></script>

    <script type="application/javascript" th:inline="javascript">
        +function ($) {
            var searchUrl = /*[[@{/search}]]*/ '#';
            var _csrf = /*[[${_csrf.token}]]*/ 'csrf_token';

            var searchAjax = function (query, cb) {
                $.ajax({
                    url: searchUrl,
                    type: 'GET',
                    data: {query: query},
                    async: false,
                    cache: false,
                    headers: {'X-CSRF-TOKEN': _csrf}
                }).done(function (data) {
                    cb($(data));
                });
            };

            $(document).ready(function () {
                $('#search-input').typeahead({
                    hint: false,
                    minLength: 1
                }, {
                    name: 'searchResults',
                    source: searchAjax,
                    templates: {
                        empty: undefined,
                        header: undefined,
                        footer: undefined,
                        suggestion: function (obj) {
                            return obj;
                        }
                    }
                });
            });
        }(jQuery);
    </script>
</div>

<div th:fragment="searchField" class="navbar-search">
    <input id="search-input"
           type="text"
           class="form-control inpt typeahead"
           autocomplete="off"
           spellcheck="false"
           placeholder="Psk..."
           style="color:  #ccc"/>
</div>

<div th:fragment="searchResults">
    <div>----- Recipes -----</div>
    <div th:each="recipe : ${results.recipes}">
        <div><img th:src="@{${recipe.imageUrl}"/></div>
        <div th:text="${recipe.name}"></div>
        <div th:text="${recipe.description}"></div>
        <div>--------------</div>
    </div>
    <div>----- Users -----</div>
    <div th:each="person : ${results.persons}">
        <div><img th:src="@{${person.imageUrl}"/></div>
        <div th:text="${person.name}"></div>
    </div>
</div>

<!-- Bootstrap javascript -->
<script th:src="@{bootstrap.min.js}" src="js/bootstrap.min.js"
        type="application/javascript"></script>

<!--Kupra javascript-->
<script th:src="@{kupra.js}" src="js/kupra.js" type="application/javascript"></script>

<!-- Material design javascript -->
<script th:src="@{ripples.min.js}" src="js/ripples.min.js"></script>
<script th:src="@{material.min.js}" src="js/material.min.js"></script>
</body>
</html>